<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		计算机网络/4_网络层/2网际协议IP | 
	 
	Hexo
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	
  

	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">


	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">Hexo</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
		
		<li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li>
		<li class="menu-item">
			<a href="https://github.com/wujun234" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="text" placeholder="search...">
		<div id="tree">
			

			
							<ul>
								<li class="file">
									<a href="/2020/05/23/hello-world/">
										hello-world
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										计算机网络
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										4_网络层
									</a>
									
							<ul>
								<li class="file">
									<a href="/2020/05/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4_%E7%BD%91%E7%BB%9C%E5%B1%82/1_%E7%BD%91%E7%BB%9C%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1/">
										1_网络层提供的两种服务
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2020/05/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4_%E7%BD%91%E7%BB%9C%E5%B1%82/2%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP/">
										2网际协议IP
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">

	2网际协议IP
</h1>
<div class="article-meta">
	
	<span>John Doe</span>
	<span>2020-05-23 12:29:25</span>
    
		<div id="article-categories">
            
		</div>
    
</div>

<div id="article-content">
	<h3 id="4-2-1-网际协议IP"><a href="#4-2-1-网际协议IP" class="headerlink" title="4.2.1 网际协议IP"></a>4.2.1 网际协议IP</h3><ul>
<li>与IP协议配套使用的还有三个协议：<ul>
<li>地址解析协议ARP</li>
<li>网际控制报文协议ICMP</li>
<li>网际组管理协议IGMP</li>
</ul>
</li>
<li>三个协议和网际协议IP的关系：<br>《图片》</li>
<li>从一般的概念来讲，将网络互相连接起来要使用一些中间设备。根据中间设备所在的层次，可以有以下四种不同的中间设别:<ol>
<li>物理层使用的中间设备叫做转发器</li>
<li>数据链路层使用的中间设备叫做网桥或桥接器</li>
<li>网络层使用的中间设备叫做路由器</li>
<li>在网络层以上使用的中间设备叫做网关。用网关链接两个不兼容的系统需要在高层进行协议的转换。</li>
</ol>
</li>
<li>由于历史的原因，许多有关的TCP/IP的文献曾经把网络层使用的路由器称为网关。</li>
<li>互联网可以由多种异构网络互联组成。</li>
</ul>
<h3 id="4-2-2-分类的IP地址"><a href="#4-2-2-分类的IP地址" class="headerlink" title="4.2.2 分类的IP地址"></a>4.2.2 分类的IP地址</h3><ul>
<li><p>所谓”分类的IP地址”就是将IP地址划分为若干个固定类，每一类地址都由两个固定长度的字段组成，其中第一个字段是网络号，它标志主机(或路由器)所连接到的网络。一个网络号在整个因特网范围内必须是唯一地。第二个字段是主机号，它标志该主机（或路由器）。一个主机号在它前面的网络号所指明的网络范围内必须是唯一的。由此可见，一个IP地址在整个因特网范围内是唯一的。</p>
  <pre>
  这种两级的IP地址可以记为：
     IP地址 ::={<网络号>,<主机号>} 
  </主机号></网络号></pre>
</li>
<li><p>从IP地址的结构来看，IP地址并不仅仅指明一个主机，而是还指明了主机所连接的网络。</p>
</li>
</ul>
<p><img src="/2020/05/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4_%E7%BD%91%E7%BB%9C%E5%B1%82/2%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP/2.png" alt="IP地址的指派范围"></p>
<ul>
<li>IP地址具有以下一些重要特点：<ul>
<li>每一个IP地址都由网络号和主机号两部分组成。从这个意义上说，IP地址是一种分等级的地址结构。分两个等级的好处是：第一，IP地址管理结构在分配IP地址时只分配网络号(第一级)，而剩下的主机号(第二级)则由得到该网络号的单位自行分配。这样就方便了IP地址的管理。第二，路由器仅根据目的主机所连接的网络号来转发分组(而不考虑目的主机号)，这样就可以使路由表中的项目数大幅度减少，从而减少了路由表所占的存储空间及路由表时间。</li>
<li>实际上IP地址是标志一个主机（或路由器）和一条链路的接口。当一个主机同时连接到两个网络上时，该主机就必须同时具有两个相应的IP地址，其网络号必须是不同的。这种主机称为多归属主机。由于一个路由器至少应当连接到两个网络，因此一个路由器至少应当有两个不同的IP地址。</li>
<li>用转发器或网桥连接起来的若干个局域网仍为一个网络，因为这些局域网都具有同样的网络号。具有不同的网络号的局域网必须使用路由器进行互联。</li>
<li>在IP地址中，所有分配到的网络号的网络都是平等的。所谓平等，是指因特网同等对待每一个IP地址。</li>
</ul>
</li>
<li>路由器总是具有两个或两个以上的IP地址。即路由器的每一个接口都有一个不同的网络号的IP地址。</li>
</ul>
<h3 id="4-2-3-IP地址与硬件地址"><a href="#4-2-3-IP地址与硬件地址" class="headerlink" title="4.2.3 IP地址与硬件地址"></a>4.2.3 IP地址与硬件地址</h3><ul>
<li>下图说明了这两种地址的区别。从层次的角度看，物理地址是数据链路层和物理层使用的地址，而IP地址是网络层和以上各层使用的地址，是一种逻辑地址。</li>
</ul>
<p><img src="/2020/05/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4_%E7%BD%91%E7%BB%9C%E5%B1%82/2%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP/3.png" alt="IP地址与硬件地址的区别"></p>
<ul>
<li>IP地址放在IP数据报的首部，而硬件地址则放在MAC帧的首部。在网络层和网络层以上使用的是IP地址，而数据链路层及以下使用的是硬件地址。</li>
<li>IP数据报放入数据链路层的MAC帧中以后，整个的IP数据报就成为MAC帧的数据，因而在数据链路层看不见数据报的IP地址。</li>
<li>强调以下几点：<ul>
<li>在IP层抽象的互联网只能看到IP数据报。</li>
<li>虽然在IP数据报首部有源站IP地址，但路由器只根据目的站的IP地址的网络号进行路由选择。</li>
<li>在局域网的链路层，只能看见MAC帧。</li>
<li>尽管互联在一起的网络的硬件地址体系各不相同，但IP层抽象的互联网却屏蔽了下层这些很复杂的细节。只要我们在网络层上讨论问题，就能够使用统一的、抽象的IP地址研究主机和主机或路由器之间的通信。</li>
</ul>
</li>
</ul>
<h3 id="4-2-4-地址解析协议ARP"><a href="#4-2-4-地址解析协议ARP" class="headerlink" title="4.2.4 地址解析协议ARP"></a>4.2.4 地址解析协议ARP</h3><ul>
<li>ARP协议属于网络层(有的教科书按照协议的所用，把ARP协议归在数据链路层，这样也可以)。</li>
<li>ARP协议的用途是为了从网络层使用的IP地址解析出在数据链路层使用的硬件地址。</li>
<li>地址解析协议ARP解决这个问题的方法是在主机ARP高速缓存中应存放一个从IP地址到硬件地址的映射表，并且这个映射表还经常动态更新(新增或超时删除)。</li>
<li>每一个主机都设有一个ARP高速缓存，里面有本局域网上的各主机和路由器的IP地址到硬件地址的映射表。</li>
<li>ARP把保存在高速缓存中的每一个映射地址项目都设置生存时间。凡超过生存时间的项目就从高速缓存中删除掉。</li>
<li>ARP是解决同一个局域网上的主机或路由器的IP地址和硬件地址的映射问题。</li>
</ul>
<h3 id="4-2-4-IP数据报的格式"><a href="#4-2-4-IP数据报的格式" class="headerlink" title="4.2.4 IP数据报的格式"></a>4.2.4 IP数据报的格式</h3><ul>
<li>一个IP数据报由首部和数据两部分组成。首部的前一部分是固定长度，共20字节，是所有IP数据报必须具有的。在首部的固定部分的后面是一些可选字段，其长度可变的。</li>
</ul>
<p><img src="/2020/05/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4_%E7%BD%91%E7%BB%9C%E5%B1%82/2%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP/4.png" alt="IP数据报的格式"></p>
<ul>
<li><p>IP数据报首部固定部分中的各字段</p>
<ul>
<li><p>版本 </p>
<ul>
<li>占4位，指IP协议的版本。</li>
</ul>
</li>
<li><p>首部长度 </p>
<ul>
<li>占4位，最常用的首部长度为20字节(即首部长度为0101)。</li>
</ul>
</li>
<li><p>区分服务 </p>
<ul>
<li>占8位，用来获得更好的服务。这个字段在旧标准中叫做服务类型，但实际上一直没有被使用过。在一般情况下都不适用这个字段。</li>
</ul>
</li>
<li><p>总长度 </p>
<ul>
<li>总长度指首部和数据之和的长度，单位位字节。总长度字段为16位。</li>
<li>我们知道，在IP层下面的每一种数据链路层协议都规定了一个数据帧中的数据字段的最大长度，这称为最大传送单元MTU（Maximun Transfer Unit）。当一个IP数据报封装成链路层的帧时，此数据报的总长度(即首部加上数据部分)一定不能超过下面的数据链路层所规定的MTU值。如果超过了就必须把过长的数据报进行分片处理。在进行分片时，数据报首部中的“总长度”字段是指分片后的每一个分片的首部长度与该分片的数据长度的总和。</li>
</ul>
</li>
<li><p>标识 </p>
<ul>
<li>占16位，当数据报由于长度超过网络的MTU而必须分片时，这个标识字段的值就被复制到所有的数据报片的标志字段中。相同的标识字段的值使分片后的各数据报最后能正确地重装成为原来的数据报。</li>
</ul>
</li>
<li><p>标志 </p>
<ul>
<li>占3位，但目前只有两位有意义。</li>
<li>标志字段中的最低位记为MF(More Fragment)。MF=1即表示后面“还有分片”的数据报。MF=0表示这已是若干数据报片的最后一个。</li>
<li>标志字段中间的一位记为DF(Don’t Fragment)，意思是“不能分片”。只有当DF=0时才允许分片。</li>
</ul>
</li>
<li><p>片偏移 </p>
<ul>
<li>占13位，片偏移指出：较长的分组在分片后，某片在原分组中的相对位置。也就是说，相对于用户数据字段的起点，该片从何时开始。片偏移以8个字节位偏移单位。这就是说，每个分片的长度一定时8字节（64位）的整数倍。</li>
</ul>
</li>
<li><p>生存时间 </p>
<ul>
<li>占8位，生存时间字段常用的英文缩写是TTL（Time To Live）,表明是数据报在网络中的寿命。最初的设计是以秒作为TTL值得单位。每经过一个路由器时，就把TTL减去数据报在路由器所消耗掉得时间。现在TTL字段得功能改为“跳数限制”，路由器在转发数据报之前就把TTL减1。若TTL值减少为零，就丢弃这个数据报，不再转发。TTL得意义是指明数据报在因特网至多可经过多少个路由器。最大数值是225。若把TTL的初始值设置为1，就表示这个数据报只能在本局域网中传送。因为这个数据报传送到局域网上的某个路由器，在被转发之前TTL值就减少到零，因而就会被这个路由器丢弃。</li>
</ul>
</li>
<li><p>协议 </p>
<ul>
<li>占8位，协议字段是指出此数据报携带的数据是使用何种协议，以便使目的主机的IP层知道应将数据部分上交给哪个处理过程。</li>
</ul>
<p>![常用的一些协议和相应的协议字段值如下](2 网际协议IP/5.png)</p>
</li>
<li><p>首部检验和 </p>
<ul>
<li>占16位，这个字段只检验数据报的首部，但不包括数据部分（IP首部的检验和不采用复杂的CRC检验码）。</li>
</ul>
</li>
<li><p>源地址 </p>
<ul>
<li>占32位</li>
</ul>
</li>
<li><p>目的地址 </p>
<ul>
<li>占32位</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-2-5-IP层转发分组的流程"><a href="#4-2-5-IP层转发分组的流程" class="headerlink" title="4.2.5 IP层转发分组的流程"></a>4.2.5 IP层转发分组的流程</h3><ul>
<li><p>在互联网上转发分组时，是从一个路由器转发到下一个路由器。</p>
</li>
<li><p>总之，在路由表中，对每一条路由最主要的是以下两个信息：</p>
<pre><code>  (目的网络地址，下一跳地址)</code></pre></li>
</ul>

</div>


    <div class="post-guide">
        <div class="item left">
            
        </div>
        <div class="item right">
            
              <a href="/2020/05/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4_%E7%BD%91%E7%BB%9C%E5%B1%82/1_%E7%BD%91%E7%BB%9C%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1/">
                1_网络层提供的两种服务
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>



	<div id="vcomments"></div>


<script>
	
		// 评论
		new Valine({
			av: AV,
			el: '#vcomments',
			notify: false,
			verify: false,
			path: window.location.pathname,
			appId: '',
			appKey: '',
			placeholder: '请输入评论',
			avatar: 'retro',
			recordIP: false
		})
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">John Doe</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			pv
			<span id="busuanzi_value_site_pv"></span>
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			uv
			<span id="busuanzi_value_site_uv"></span>
		</span>
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>